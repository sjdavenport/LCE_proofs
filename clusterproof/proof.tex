\documentclass[11pt]{article}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amsthm,amssymb}
\usepackage[margin=1in]{geometry}
\usepackage{enumitem}

% Theorem environments
\newtheorem{theorem}{Theorem}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{definition}[theorem]{Definition}

\theoremstyle{remark}
\newtheorem{remark}{Remark}

\usepackage{xcolor}
\newcommand{\sdcom}[1]{\textit{\color{red} [SD: #1]}}

\title{Superthreshold Clusters Containing TFCE-Significant Clusters are LCE-Significant}
\author{}
\date{}

\begin{document}

\maketitle

\section{Main Result}

\begin{lemma}\label{lem:cluster_containment}
Let $R'$ be an $h_0$-superthreshold cluster for a cluster defing threshold $h_0 \in \mathbb{R}$. Then for any $v \in R'$ and any $h \geq h_0$, the connected component $C_v(h)$ containing $v$ of the excursion set $\mathcal{E}(h) = \{w \in \mathcal{B} : T_w \geq h\}$  satisfies $C_v(h) \subseteq R'$.
\end{lemma}

\begin{proof}
Since $R'$ is an $h_0$-superthreshold cluster, all voxels in $\mathcal{B} \setminus R'$ that are neighbors of $R'$ have $T_w < h_0 \leq h$. Therefore, the connected component $C_v(h)$ cannot extend beyond $R'$.
\end{proof}

\begin{theorem}\label{thm:main}
Let $R$ be a TFCE-significant cluster. Then any $h_0$-superthreshold cluster $R' \supseteq R$ is LCE-significant.
\end{theorem}

\begin{proof}
Let $R$ be a TFCE-significant cluster. By definition, for all $v \in R$ we have $S_v(\mathbf{X}_\mathcal{B}) \geq t^*_\mathcal{B}$.

\medskip
\noindent\textbf{Step 1: TFCE-significant voxels lie in $h_0$-superthreshold clusters.}

\medskip
If $T_v < h_0$, then $v \notin \mathcal{E}(h)$ for all $h \geq h_0$, so $e_v(h) = 0$ and hence $S_v = 0$. Since $t^*_\mathcal{B} > 0$, any TFCE-significant voxel must have $T_v \geq h_0$ and therefore lies in an $h_0$-superthreshold cluster.

\medskip
\noindent\textbf{Step 2: TFCE statistics are unchanged after masking to $R'$.}

\medskip
Let $R'$ be any $h_0$-superthreshold cluster containing $R$. For any $v \in R'$ and any $h \geq h_0$, we claim that:
\[
e_v(h, \mathbf{X}_{R'}) = e_v(h, \mathbf{X}_\mathcal{B}).
\]

By Lemma~\ref{lem:cluster_containment}, $C_v(h) \subseteq R'$. Since masking to $R'$ does not affect the cluster $C_v(h)$, we have:
\[
e_v(h, \mathbf{X}_{R'}) = |C_v(h)| = e_v(h, \mathbf{X}_\mathcal{B}).
\]

Consequently, for all $v \in R'$:
\[
S_v(\mathbf{X}_{R'}) = \int_{h_0}^{\infty} f(h) g(e_v(h, \mathbf{X}_{R'})) \, dh = \int_{h_0}^{\infty} f(h) g(e_v(h, \mathbf{X}_\mathcal{B})) \, dh = S_v(\mathbf{X}_\mathcal{B}).
\]

\medskip
\noindent\textbf{Step 3: Concluding LCE significance.}

\medskip
Since $R \subseteq R'$, there exists $v \in R \subseteq R'$ such that:
\[
S_v(\mathbf{X}_{R'}) = S_v(\mathbf{X}_\mathcal{B}) \geq t^*_\mathcal{B}.
\]

Therefore:
\[
\max_{v \in R'} S_v(\mathbf{X}_{R'}) \geq t^*_\mathcal{B}.
\]

By the definition of LCE significance, $R'$ is LCE-significant.
\end{proof}

\begin{corollary}\label{cor:support}
For any TFCE-significant cluster $R$, its support (the $h_0$-superthreshold cluster containing $R$) is LCE-significant.
\end{corollary}

\begin{proof}
By Step 1, every voxel in $R$ satisfies $T_v \geq h_0$, so $R$ is contained in a unique $h_0$-superthreshold cluster $R'$. The result follows immediately from Theorem~\ref{thm:main}.
\end{proof}

\begin{remark}
The key insight of this proof is that $h_0$-superthreshold clusters act as ``islands'' in the test statistic map: when masking to such a cluster, the TFCE statistics for voxels inside the cluster remain unchanged because the cluster boundaries (where $T_v < h_0$) prevent any information from voxels outside the region from influencing the statistic. This is precisely why the threshold $h_0$ plays such a crucial role in determining the spatial support of valid TFCE inference.
\end{remark}

\begin{corollary}
For every TFCE-significant cluster $R$, there exists a unique minimal $h_0$-superthreshold cluster $R' \supseteq R$ that is LCE-significant. This cluster $R'$ is precisely the connected component of $\{v \in \mathcal{B} : T_v \geq h_0\}$ containing $R$.
\end{corollary}

\end{document}
